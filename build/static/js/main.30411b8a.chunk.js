(this["webpackJsonptabletop-stats"]=this["webpackJsonptabletop-stats"]||[]).push([[0],{125:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(10),l=t.n(c),o=t(7),s=t.n(o),i=t(16),u=t(47),m=t(9),p=t(32),d=t(173),f=t(82),v=t(12),b=t(183),g=t(182),E=t(181),h=t(189),y=t(188),w=t(178),x=t(126),j=t(167),O=t(168),S=t(34),k=function(e){var a=e.icon,t=e.primary,n=e.to;return r.a.createElement("li",null,r.a.createElement(x.a,{button:!0,component:S.b,to:n},a?r.a.createElement(j.a,null,a):null,r.a.createElement(O.a,{primary:t})))},C=t(84),N=t.n(C),G=t(184),P=t(54),A=t(20),B=t.n(A),D=null,F=function(e){var a;return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(B.a.post("/api/login",e));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}))},I=function(e){D="bearer ".concat(e)},T=function(){return D},U=function(){var e;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(B.a.get("/api/games"));case 2:return e=a.sent,a.abrupt("return",e.data);case 4:case"end":return a.stop()}}))},H=function(e){var a,t;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a={headers:{Authorization:T()}},n.next=3,s.a.awrap(B.a.post("/api/games",e,a));case 3:return t=n.sent,n.abrupt("return",t.data);case 5:case"end":return n.stop()}}))},M=function(e){var a;return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return a=B.a.get("".concat("/api/games","/").concat(e)),t.abrupt("return",a.data);case 2:case"end":return t.stop()}}))},z=t(13),J=t(190),R=t(174),W=t(175),q=t(176),L=t(81),V=t.n(L),K=t(169),Q=t(127),X=Object(Q.a)((function(e){return{root:{position:"fixed",borderRadius:"0.5em",bottom:e.spacing(2),right:e.spacing(2)}}})),Y=function(e){var a=X();return r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{onClick:e.handleClick,className:a.root,color:"secondary","aria-label":"add"},r.a.createElement(V.a,null)))},Z=Object(f.a)({item:{width:"11.5em"},cardContent:{bottom:0,position:"absolute",padding:"0.4em 0.8em 0 1em","&:last-child":{paddingBottom:"0.5em"}},card:{position:"relative",borderRadius:"10px",height:"10em"}}),$=function(e){var a=e.value,t=e.handleGameChange,n=e.handleAddGame;return r.a.createElement("form",{onSubmit:n},r.a.createElement(J.a,{id:"new-game",label:"Add game",variant:"outlined",color:"secondary",autoFocus:!0,value:a,onChange:t}))},_=function(e){var a=e.games,t=e.setGames,c=e.user,l=Z(),o=Object(n.useState)(null),u=Object(i.a)(o,2),m=u[0],p=u[1],d=Object(n.useState)(!1),f=Object(i.a)(d,2),v=f[0],b=f[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},a.map((function(e){return r.a.createElement(R.a,{key:e.id,item:!0,className:l.item},r.a.createElement(S.b,{to:"/game-stats/".concat(e.id)},r.a.createElement(W.a,{className:l.card},r.a.createElement(q.a,{className:l.cardContent},r.a.createElement(P.a,{align:"left",style:{fontSize:"1.2em"}},e.title)))))}))),c&&v&&r.a.createElement($,{value:m,handleGameChange:function(e){p(e.target.value)},handleAddGame:function(e){var n,r;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e.preventDefault(),n={title:m},c.prev=2,c.next=5,s.a.awrap(H(n));case 5:r=c.sent,t([].concat(Object(z.a)(a),[r])),b(!1),p(""),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(2),console.log("failed to create game",c.t0);case 14:case"end":return c.stop()}}),null,null,[[2,11]])}}),c&&r.a.createElement(Y,{handleClick:function(){b(!v),p("")}}))},ee=Object(f.a)({item:{width:"11.5em"},cardContent:{padding:"0.4em 0.8em 0 1em","&:last-child":{paddingBottom:"0.5em"}},card:{borderRadius:"10px"},title:{fontSize:"1.8em",lineHeight:"1.25em",paddingBottom:"0.3em"}}),ae=function(e){var a=e.title,t=e.value,n=e.classes;return a&&t?r.a.createElement(R.a,{item:!0,className:n.item},r.a.createElement(W.a,{className:n.card},r.a.createElement(q.a,{className:n.cardContent},r.a.createElement(P.a,{className:n.title,color:"textSecondary"},a),r.a.createElement(P.a,{align:"right",variant:"h4",component:"h2"},t),e.children))):null},te=function(e){var a=e.matches,t=ee(),n=a.map((function(e){return e.players})).flat(),c=n.map((function(e){return e.points})),l=+(c.reduce((function(e,a){return e+a}),0)/c.length).toFixed(2),o=function(e){if(e){for(var a=e.map((function(e){return e.players})),t=new Map,n=0;n<a.length;n++){var r=a[n].reduce((function(e,a){return a.points>e.points?a:e})),c=t.get(r.player.name);c?t.set(r.player.name,c+1):t.set(r.player.name,1)}var l=Object(z.a)(t.entries()).reduce((function(e,a){return a[1]>e[1]?a:e}),[0,0]);return{name:l[0],wins:l[1]}}}(a),s=n.length>0?n.reduce((function(e,a){return a.points>e.points?a:e})):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(ae,{title:"Games played",value:a.length,classes:t}),r.a.createElement(ae,{title:"Average points",value:l,classes:t}),s&&r.a.createElement(ae,{title:"Most points",value:s.points,classes:t},r.a.createElement(P.a,{color:"textSecondary",variant:"body1",component:"p",align:"right"},s.player.name)),o&&r.a.createElement(ae,{title:"Most wins",value:o.wins,classes:t},r.a.createElement(P.a,{color:"textSecondary",variant:"body1",component:"p",align:"right"},o.name))))},ne=t(179),re=t(87),ce=t(180),le=t(172),oe=t(192),se=t(186),ie=t(177),ue=t(194),me=function(e){var a=e.selectedPlayers,t=e.player,n=e.players,c=e.removePlayer,l=e.updatePlayer,o=a.map((function(e){return e.name}));return r.a.createElement(R.a,{container:!0,spacing:1,justify:"center"},r.a.createElement(R.a,{item:!0,md:6,xs:5},r.a.createElement(le.a,{fullWidth:!0,variant:"outlined",required:!0},r.a.createElement(oe.a,{id:"player-label"},"Player"),r.a.createElement(se.a,{labelId:"player-label",id:"player",value:t.name,onChange:function(e){return function(e){var a=Object(u.a)({},t,{name:e});l(a)}(e.target.value)}},n.map((function(e){return r.a.createElement(ie.a,{key:e.name,disabled:o.includes(e.name),value:e.name},e.name)}))))),r.a.createElement(R.a,{item:!0,md:5,xs:5},r.a.createElement(J.a,{fullWidth:!0,required:!0,id:"points",label:"Points",type:"number",defaultValue:t.points,onChange:function(e){return function(e){var a=Object(u.a)({},t,{points:Number(e)});l(a)}(e.target.value)},variant:"outlined"})),r.a.createElement(R.a,{item:!0,xs:1},r.a.createElement(w.a,{"aira-label":"delete",onClick:function(){return c(t)}},r.a.createElement(ue.a,null))))},pe=function(){var e;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(B.a.get("/api/players"));case 2:return e=a.sent,a.abrupt("return",e.data);case 4:case"end":return a.stop()}}))},de=t(83),fe=t.n(de),ve=function(e){var a=e.handleSubmit,t=Object(n.useState)([]),c=Object(i.a)(t,2),l=c[0],o=c[1],u=Object(n.useState)([]),m=Object(i.a)(u,2),p=m[0],d=m[1],f={marginTop:p.length>0?"2em":null};Object(n.useEffect)((function(){!function(){var e;s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.a.awrap(pe());case 3:e=a.sent,o(e),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log("failed to fetch player data",a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]])}()}),[]);var v=function(e){var a=p.map((function(a){return a.id!==e.id?a:e}));d(a)},b=function(e){var a=p.filter((function(a){return a.id!==e.id}));d(a)};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=p.filter((function(e){return e.name}));if(!(t.length<1)){var n=t.map((function(e){var a=l.find((function(a){return a.name===e.name}));return a?{player:a.id,points:e.points}:null}));a(n)}}},r.a.createElement(ne.a,{maxWidth:"sm",disableGutters:!0},r.a.createElement(re.a,{style:{padding:"2em"}},p.map((function(e){return r.a.createElement(me,{key:e.id,player:e,players:l,selectedPlayers:p,removePlayer:b,updatePlayer:v})})),r.a.createElement(ne.a,{disableGutters:!0},r.a.createElement(R.a,{container:!0,justify:"space-between",style:f},r.a.createElement(R.a,{item:!0},r.a.createElement(ce.a,{variant:"outlined",color:"primary",onClick:function(){var e={id:fe()(),name:"",points:null};d([].concat(Object(z.a)(p),[e]))}},"Add player")),r.a.createElement(R.a,{item:!0},r.a.createElement(ce.a,{variant:"contained",color:"primary",type:"submit"},"Submit"))))))))},be=function(e){var a,t;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a={headers:{Authorization:T()}},n.next=3,s.a.awrap(B.a.post("/api/matches",e,a));case 3:return t=n.sent,n.abrupt("return",t.data);case 5:case"end":return n.stop()}}))},ge=function(e){var a;return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.awrap(B.a.get("".concat("/api/matches","/game/").concat(e)));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}))},Ee=function(e){var a=e.gameId,t=e.setHeader,c=e.user,l=Object(n.useState)([]),o=Object(i.a)(l,2),u=o[0],m=o[1],p=Object(n.useState)(!1),d=Object(i.a)(p,2),f=d[0],v=d[1];Object(n.useEffect)((function(){!function(){var e;s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.awrap(ge(a));case 3:e=t.sent,m(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("failed to get match data",t.t0);case 10:case"end":return t.stop()}}),null,null,[[0,7]])}(),function(){var e;s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.a.awrap(M(a));case 3:e=n.sent,t(e),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log("failed to fetch header",n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]])}()}),[a,t]);return r.a.createElement(r.a.Fragment,null,c&&r.a.createElement(Y,{handleClick:function(){return v(!f)}}),c&&f?r.a.createElement(ve,{handleSubmit:function(e){var t,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t={game:a,players:e},r.prev=1,r.next=4,s.a.awrap(be(t));case 4:n=r.sent,m([].concat(Object(z.a)(u),[n])),v(!1),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),console.log("failed to create a new match",r.t0);case 12:case"end":return r.stop()}}),null,null,[[1,9]])}}):r.a.createElement(te,{matches:u}))},he=t(170),ye=function(e){var a=e.setUser,t=e.user,c=Object(n.useState)(""),l=Object(i.a)(c,2),o=l[0],u=l[1],m=Object(n.useState)(""),p=Object(i.a)(m,2),d=p[0],f=p[1],v=function(e){var t;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.prev=1,n.next=4,s.a.awrap(F({username:o,password:d}));case 4:t=n.sent,window.localStorage.setItem("loggedTabletopAppUser",JSON.stringify(t)),I(t.token),a(t),u(""),f(""),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),console.log("failed to login",n.t0);case 15:case"end":return n.stop()}}),null,null,[[1,12]])},b=function(e){e.preventDefault(),window.localStorage.removeItem("loggedTabletopAppUser"),a(null)};return r.a.createElement("div",null,null===t?r.a.createElement("form",{onSubmit:v},r.a.createElement(le.a,null,r.a.createElement(he.a,{id:"username",value:o,color:"secondary",placeholder:"username",onChange:function(e){var a=e.target;return u(a.value)}})),r.a.createElement(le.a,null,r.a.createElement(he.a,{id:"password",value:d,type:"password",color:"secondary",placeholder:"password",onChange:function(e){var a=e.target;return f(a.value)}})),r.a.createElement(ce.a,{variant:"contained",color:"secondary",type:"submit"},"login")):r.a.createElement("form",{onSubmit:b},r.a.createElement(ce.a,{variant:"contained",color:"secondary",type:"submit"},"logout")))},we=Object(f.a)((function(e){return{root:{display:"flex"},drawer:Object(m.a)({},e.breakpoints.up("sm"),{width:240,flexShrink:0}),appBar:Object(m.a)({},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(240,"px)"),marginLeft:240}),menuButton:Object(m.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,toolbarDrawer:Object(u.a)({},e.mixins.toolbar),drawerPaper:{width:240},content:{flexGrow:1,padding:e.spacing(3)}}})),xe=function(e){var a=we(),t=Object(v.a)(),c=Object(n.useState)(!1),l=Object(i.a)(c,2),o=l[0],u=l[1],m=Object(n.useState)(""),f=Object(i.a)(m,2),x=f[0],j=f[1],O=Object(n.useState)([]),S=Object(i.a)(O,2),C=S[0],A=S[1],B=Object(n.useState)(null),D=Object(i.a)(B,2),F=D[0],T=D[1];Object(n.useEffect)((function(){var e=window.localStorage.getItem("loggedTabletopAppUser");if(e){var a=JSON.parse(e);a&&(T(a),I(a.token))}try{!function(){var e;s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(U());case 2:e=a.sent,A(e);case 4:case"end":return a.stop()}}))}()}catch(t){console.log("failed to fetch game data")}}),[]);var H=function(){u(!o)},M=r.a.createElement("div",null,r.a.createElement("div",{className:a.toolbar}),r.a.createElement(E.a,null),r.a.createElement(d.a,null,r.a.createElement(k,{key:"Home",to:"/",primary:"Home"}),r.a.createElement(k,{key:"Games",to:"/game-stats",primary:"Games"})));return r.a.createElement("div",{className:a.root},r.a.createElement(g.a,null),r.a.createElement(b.a,{style:{boxShadow:"none"},color:"primary",position:"fixed",className:a.appBar},r.a.createElement(G.a,null,r.a.createElement(w.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:H,className:a.menuButton},r.a.createElement(N.a,null)),r.a.createElement(P.a,{color:"textPrimary",variant:"h6",noWrap:!0},x))),r.a.createElement("div",{className:a.drawer,"aria-label":"games stats"},r.a.createElement(y.a,{smUp:!0,implementation:"css"},r.a.createElement(h.a,{variant:"temporary",anchor:"rtl"===t.direction?"right":"left",open:o,onClose:H,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0}},M)),r.a.createElement(y.a,{xsDown:!0,implementation:"css"},r.a.createElement(h.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},M))),r.a.createElement("div",{className:a.content},r.a.createElement("div",{className:a.toolbar}),r.a.createElement(p.a,{exact:!0,path:"/",render:function(){return j(""),r.a.createElement(ye,{setUser:T,user:F})}}),r.a.createElement(p.a,{exact:!0,path:"/game-stats",render:function(){return j("Games"),r.a.createElement(_,{games:C,setGames:A,user:F})}}),r.a.createElement(p.a,{exact:!0,path:"/game-stats/:game",render:function(e){var a=e.match;return r.a.createElement(Ee,{gameId:a.params.game,setHeader:j,user:F})}})))},je=function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(xe,null)))},Oe=t(185),Se=t(85),ke=Object(Se.a)({palette:{primary:{main:"#e77d11",contrastText:"#6E4B20"},secondary:{main:"#ffd59a",contrastText:"#6E4B20"},text:{primary:"#551c02",secondary:"#9B8D75"},background:{default:"#e77d11"}},typography:{fontFamily:["Arvo","serif"].join(",")}});l.a.render(r.a.createElement(Oe.a,{theme:ke},r.a.createElement(je,null)),document.getElementById("root"))},95:function(e,a,t){e.exports=t(125)}},[[95,1,2]]]);
//# sourceMappingURL=main.30411b8a.chunk.js.map